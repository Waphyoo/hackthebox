# Introduction to Password Cracking

## การแฮชรหัสผ่าน (Password Hashing)

รหัสผ่านมักถูกแฮช (Hash) ก่อนเก็บเพื่อป้องกันในกรณีที่ข้อมูลตกไปอยู่ในมือของผู้โจมตี

### Hash Function คืออะไร?
ฟังก์ชันทางคณิตศาสตร์ที่แปลงข้อมูลขนาดใดก็ได้ให้เป็นข้อมูลขนาดคงที่

**ตัวอย่าง Hash Function ที่นิยม:**
- MD5
- SHA-256

### ตัวอย่างการแฮช

รหัสผ่าน: `Soccer06!`

```bash
# MD5 Hash
echo -n Soccer06! | md5sum
# ผลลัพธ์: 40291c1d19ee11a7df8495c4cccefdfa

# SHA-256 Hash
echo -n Soccer06! | sha256sum
# ผลลัพธ์: a025dc6fabb09c2b8bfe23b5944635f9b68433ebd9a1a09453dd4fee00766d93
```

### คุณสมบัติของ Hash Function

**One-way Function (ฟังก์ชันทางเดียว):**
- ไม่สามารถย้อนกลับจาก Hash เป็นรหัสผ่านเดิมได้
- ผู้โจมตีต้องพยายามถอดรหัส (Password Cracking)

---

## เทคนิคการถอดรหัสผ่าน

### 1. Rainbow Tables

**คำนิยาม:**
ตารางที่รวบรวม Input และ Output ของ Hash Function ไว้ล่วงหน้า สามารถระบุรหัสผ่านได้อย่างรวดเร็วถ้า Hash ถูกบันทึกไว้แล้ว

**ตัวอย่าง Rainbow Table:**

| Password | MD5 Hash |
|----------|----------|
| 123456 | e10adc3949ba59abbe56e057f20f883e |
| 12345 | 827ccb0eea8a706c4c34a16891f84e7b |
| 123456789 | 25f9e794323b453885f5181f1b624d0b |
| password | 5f4dcc3b5aa765d61d8327deb882cf99 |
| iloveyou | f25a2fc72690b780b2a14e140ef6a9e0 |
| princess | 8afa847f50a716e64932d995c8e7435a |
| rockyou | f806fc5a2a0d5ba2471600758452799c |
| abc123 | e99a18c428cb38d5f260853678922e03 |

### การป้องกัน Rainbow Tables: Salting

**Salt คืออะไร?**
ลำดับไบต์แบบสุ่มที่เพิ่มเข้าไปในรหัสผ่านก่อนทำการแฮช

**ตัวอย่าง:**
```bash
# รหัสผ่านเดิม: Soccer06!
# Salt: Th1sIsTh3S@lt_
# รหัสผ่านที่มี Salt: Th1sIsTh3S@lt_Soccer06!

echo -n Th1sIsTh3S@lt_Soccer06! | md5sum
# ผลลัพธ์: 90a10ba83c04e7996bc53373170b5474
```

**ทำไม Salting ถึงได้ผล?**
- Salt ไม่ใช่ค่าลับ แต่ต้องใช้ในการตรวจสอบรหัสผ่าน
- Salt มักจะแนบไว้หน้า Hash
- แม้รหัสผ่านจะถูกบันทึกใน Rainbow Table แล้ว แต่รหัสผ่าน+Salt ยังไม่ถูกบันทึก
- **ตัวอย่าง:** Salt แค่ 1 ไบต์ จะทำให้ตารางที่มี 15 พันล้านรายการ ต้องขยายเป็น 3.84 ล้านล้านรายการ (คูณด้วย 256)

---

### 2. Brute-force Attack

**คำนิยาม:**
ลองทุกความเป็นไปได้ของตัวอักษร ตัวเลข และสัญลักษณ์จนกว่าจะพบรหัสผ่านที่ถูกต้อง

**ตัวอย่างการลองแบบ Brute-force:**

| Brute-force Attempt | MD5 Hash |
|---------------------|----------|
| Sxejd | 2cdc813ef26e6d20c854adb107279338 |
| Sxeje | 7703349a1f943f9da6d1dfcda51f3b63 |
| Sxejf | db914f10854b97946046eabab2287178 |
| Sxejg | c0ceb70c0e0f2c3da94e75ae946f29dc |
| Sxejh | 4dca0d2b706e9344985d48f95e646ce8 |
| Sxeji | 66b5fa128df895d50b2d70353a7968a7 |

**ข้อดี:**
- มีประสิทธิภาพ 100% (ถ้ามีเวลาเพียงพอ จะถอดรหัสได้แน่นอน)

**ข้อเสีย:**
- ใช้เวลานานมาก โดยเฉพาะรหัสผ่านยาว
- รหัสผ่านสั้น (<9 ตัวอักษร) สามารถถอดรหัสได้แม้บนฮาร์ดแวร์ทั่วไป
- แทบไม่ค่อยใช้กับรหัสผ่านที่แข็งแรง มักเปลี่ยนไปใช้ Mask Attack แทน

**ความเร็วในการถอดรหัส:**
ขึ้นอยู่กับ Hash Algorithm และฮาร์ดแวร์ที่ใช้

**ตัวอย่างความเร็วด้วย Hashcat บนแล็ปท็อปทั่วไป:**
- MD5: มากกว่า 5 ล้านรหัสผ่านต่อวินาที
- DCC2: เพียง 10,000 รหัสผ่านต่อวินาที

---

### 3. Dictionary Attack (Wordlist Attack)

**คำนิยาม:**
เทคนิคที่มีประสิทธิภาพที่สุดในการถอดรหัสผ่าน โดยเฉพาะเมื่อมีเวลาจำกัด แทนที่จะลองทุกความเป็นไปได้ จะใช้รายการรหัสผ่านที่มีแนวโน้มจะถูกใช้มากที่สุด

**Wordlist ยอดนิยม:**
- **rockyou.txt** - มีรหัสผ่านจริงมากกว่า 14 ล้านรายการ
- **SecLists**

**ประวัติ rockyou.txt:**
เว็บไซต์ RockYou ถูกแฮกในปี 2009 และเก็บรหัสผ่านผู้ใช้แบบไม่เข้ารหัส (unencrypted)!

**ตัวอย่าง 20 รหัสผ่านแรกจาก rockyou.txt:**

```bash
head --lines=20 /usr/share/wordlists/rockyou.txt
```

```
123456
12345
123456789
password
iloveyou
princess
1234567
rockyou
12345678
abc123
nicole
daniel
babygirl
monkey
lovely
jessica
654321
michael
ashley
qwerty
```

---

## สรุปเปรียบเทียบเทคนิค

| เทคนิค | ความเร็ว | ประสิทธิภาพ | ข้อจำกัด |
|--------|----------|-------------|----------|
| **Rainbow Tables** | เร็วมาก | สูงถ้าไม่มี Salt | ไม่ได้ผลกับรหัสผ่านที่มี Salt |
| **Brute-force** | ช้ามาก | 100% (ถ้ามีเวลา) | ไม่เหมาะกับรหัสผ่านยาว |
| **Dictionary** | เร็ว | สูงมากกับรหัสผ่านทั่วไป | ขึ้นกับคุณภาพของ Wordlist |

---

## ข้อควรจำ

1. **Hash Function** ทำงานทางเดียว ไม่สามารถย้อนกลับได้
2. **Salting** เป็นวิธีป้องกันที่มีประสิทธิภาพต่อ Rainbow Tables
3. **Brute-force** ใช้เวลานาน แต่มีประสิทธิภาพ 100%
4. **Dictionary Attack** เหมาะกับงาน Penetration Testing ที่มีเวลาจำกัด
5. ความเร็วในการถอดรหัสขึ้นอยู่กับ **Algorithm** และ **Hardware**