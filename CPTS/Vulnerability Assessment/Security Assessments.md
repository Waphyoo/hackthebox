# การประเมินความปลอดภัย (Security Assessments)

## ภาพรวม
ทุกองค์กรจำเป็นต้องทำการประเมินความปลอดภัยของระบบเครือข่าย คอมพิวเตอร์ และแอปพลิเคชันอย่างสม่ำเสมอ เพื่อค้นหาและยืนยันช่องโหว่ที่มีอยู่ เพื่อนำไปแก้ไข ลดความเสี่ยง หรือกำจัดออกไป

## 1. Vulnerability Assessment (การประเมินช่องโหว่)

**คืออะไร**: การประเมินตามมาตรฐานความปลอดภัยที่กำหนด โดยการตรวจสอบตาม checklist ว่าระบบเป็นไปตามมาตรฐานหรือไม่

**เหมาะกับ**: ทุกองค์กร ไม่ว่าจะขนาดใดก็ตาม

**วิธีการ**:
- ตรวจสอบตามมาตรฐานความปลอดภัยต่างๆ เช่น GDPR, OWASP
- ใช้เครื่องมือสแกนหาช่องโหว่
- ตรวจสอบยืนยันช่องโหว่ที่มีความเสี่ยงสูง กลาง และวิกฤต
- **ไม่มี**การจำลองการโจมตีจริง

**ข้อดี**: ประหยัดค่าใช้จ่าย ไม่ต้องการทักษะสูงมาก

**ข้อเสีย**: อาจพลาดช่องโหว่บางตัว คำแนะนำเป็นแบบทั่วไป

## 2. Penetration Test (การทดสอบการเจาะระบบ)

**คืออะไร**: การจำลองการโจมตีทางไซเบอร์เพื่อทดสอบว่าระบบสามารถถูกเจาะเข้าไปได้หรือไม่ และอย่างไร ดำเนินการโดยได้รับความยินยอมทางกฎหมายอย่างเป็นทางการ

### ประเภทของ Penetration Test

#### **Black Box Pentesting**
- ทดสอบโดยไม่มีความรู้เกี่ยวกับระบบเลย
- มองจากมุมมองของผู้โจมตีภายนอก
- มักจ้างบุคคลภายนอกมาทำ

#### **Grey Box Pentesting**
- มีความรู้เกี่ยวกับระบบบ้าง
- มองจากมุมมองของพนักงานทั่วไป (ไม่ใช่ทีม IT)
- ได้รับข้อมูล IP address หรือ network range ที่อนุญาตให้ทดสอบ

#### **White Box Pentesting**
- มีข้อมูลครบถ้วนทุกอย่าง (ระบบ, การตั้งค่า, source code)
- เป้าหมายคือค้นหาช่องโหว่ให้มากที่สุด
- มักรวมถึงการตรวจสอบ source code

### ความเชี่ยวชาญเฉพาะด้านของ Pentester

#### **Application Pentester**
- ทดสอบ web applications, mobile apps, APIs
- เชี่ยวชาญการตรวจสอบ source code

#### **Network/Infrastructure Pentester**
- ทดสอบเครือข่าย, อุปกรณ์เครือข่าย, servers, workstations
- ต้องเข้าใจ networking, Windows, Linux, Active Directory
- ใช้เครื่องมือเช่น Nessus ร่วมด้วย (แต่ไม่ใช่เพียงอย่างเดียว)

#### **Physical Pentester**
- ทดสอบความปลอดภัยทางกายภาพ
- ลองเข้าไปในอาคาร data center โดยไม่ได้รับอนุญาต
- เช่น เปิดประตูด้วยวิธีผิดปกติ, แอบตามคนอื่นเข้าไป, คลานผ่านช่องลม

#### **Social Engineering Pentester**
- ทดสอบคน/พนักงาน
- ใช้เทคนิค phishing, vishing (โทรศัพท์หลอกลวง)
- แอบอ้างเป็นพนักงานเพื่อเข้าสู่พื้นที่ต่างๆ

### เหมาะกับใคร
องค์กรที่มี **Security Maturity ระดับกลางถึงสูง** (ความเป็นผู้ใหญ่ทางความปลอดภัย) ซึ่งต้องใช้เวลาหลายปีสร้าง ได้แก่:
- มีทีมความปลอดภัยที่มีความรู้
- มีนโยบายและการบังคับใช้ที่ดี
- มี CISO, CTO, CSIRT
- มีวัฒนธรรมความปลอดภัยที่แข็งแรง
- ทำ Vulnerability Assessment มาแล้วหลายครั้ง

**ข้อดี**: วิเคราะห์เชิงลึก คำแนะนำเฉพาะเจาะจง แสดงโซ่การโจมตีจริง

**ข้อเสีย**: ต้องใช้ค่าใช้จ่ายสูง ต้องการความเชี่ยวชาญสูง

## 3. เปรียบเทียบ Vulnerability Assessment vs Penetration Test

| หัวข้อ | Vulnerability Assessment | Penetration Test |
|--------|-------------------------|------------------|
| วัตถุประสงค์ | หาช่องโหว่ตาม checklist | จำลองการโจมตีจริง |
| วิธีการ | สแกนและตรวจสอบยืนยัน | โจมตีจริง รวมถึง privilege escalation, lateral movement |
| ความเหมาะสม | ทุกองค์กร | องค์กรที่มี security maturity |
| ค่าใช้จ่าย | ต่ำกว่า | สูงกว่า |
| ความถี่ | รายเดือนหรือรายไตรมาส | รายปีหรือครึ่งปี |

**หมายเหตุ**: ทั้งสองแบบไม่ได้ "ดีกว่า" กัน แต่ใช้ในสถานการณ์ที่ต่างกัน และสามารถทำร่วมกันได้

## 4. การประเมินความปลอดภัยประเภทอื่นๆ

### Security Audits (การตรวจสอบความปลอดภัย)
- **บังคับโดย**: หน่วยงานภาครัฐหรือสมาคมอุตสาหกรรม
- **วัตถุประสงค์**: ตรวจสอบการปฏิบัติตามกฎระเบียบ
- **ตัวอย่าง**: PCI-DSS สำหรับร้านค้าที่รับชำระด้วยบัตรเครดิต
- **ผลกระทบ**: หากไม่ผ่านอาจโดนปรับและห้ามรับชำระด้วยบัตร

### Bug Bounties (โปรแกรมรางวัลหาช่องโหว่)
- เปิดให้คนทั่วไปหาช่องโหว่ในระบบ
- จ่ายรางวัลตั้งแต่หลักร้อยถึงหลักแสนเหรียญ
- **เหมาะกับ**: บริษัทใหญ่ที่มี security maturity สูง มีทีมเฉพาะในการตรวจสอบรายงาน
- **ตัวอย่าง**: Microsoft, Apple

### Red Team Assessment (การประเมินโดยทีมแดง)
- **คืออะไร**: การจำลองการโจมตีแบบ evasive black box จากมุมมองของผู้โจมตีภายนอก
- **วิธีการ**: มีเป้าหมายที่ชัดเจน (เช่น เข้าถึง server หรือ database ที่สำคัญ)
- **รายงาน**: รายงานเฉพาะช่องโหว่ที่นำไปสู่เป้าหมาย ไม่ใช่ทุกช่องโหว่ที่พบ
- **ทีมภายใน**: ทำ pentesting แบบ grey/white box อย่างต่อเนื่อง
- **เหมาะกับ**: องค์กรที่มีงบประมาณมาก มีทรัพยากรเพียงพอ

### Purple Team Assessment (การประเมินโดยทีมสีม่วง)
- **ทีมสีแดง (Red Team)**: ฝ่ายโจมตี (Offensive Security)
- **ทีมสีน้ำเงิน (Blue Team)**: ฝ่ายป้องกัน (Defensive Security) - มักอยู่ใน SOC หรือ CSIRT
- **ทีมสีม่วง (Purple Team)**: ความร่วมมือระหว่างทีมแดงและทีมน้ำเงิน
- **วิธีการ**: 
  - ทีมแดงหาช่องโหว่
  - ทีมน้ำเงินเรียนรู้และแก้ไขปัญหาทันที
  - ทำงานร่วมกันตั้งแต่เริ่มต้น
  - ทีมน้ำเงินอาจมีส่วนร่วมในการออกแบบแคมเปญทดสอบ
- **ตัวอย่าง**: "เราต้องการปรับปรุง PCI DSS compliance ดังนั้นให้ทีมน้ำเงินดูทีมแดงทดสอบระบบ point-of-sale และให้ feedback แบบ real-time"

# Vulnerability Assessment (การประเมินช่องโหว่)

## ภาพรวม
**Vulnerability Assessment** คือการระบุและจัดหมวดหมู่ความเสี่ยงของจุดอ่อนด้านความปลอดภัยที่เกี่ยวข้องกับทรัพย์สินในสภาพแวดล้อมขององค์กร 

**จุดสำคัญ**:
- **ไม่มี**การโจมตีจริง (manual exploitation) หรือมีน้อยมาก
- มุ่งเน้นการค้นหาและจัดหมวดหมู่ความเสี่ยง
- ให้คำแนะนำในการแก้ไขปัญหา

## วัตถุประสงค์

1. **เข้าใจ ระบุ และจัดหมวดหมู่ความเสี่ยง** ของปัญหาที่ชัดเจนในสภาพแวดล้อม โดยไม่ต้องโจมตีจริง
2. **ยืนยันช่องโหว่** (ตามที่ลูกค้าต้องการ) โดยการโจมตีเพียงเล็กน้อยเพื่อยืนยันผลจากเครื่องมือสแกนและกำจัด false positive
3. **จัดการช่องโหว่** (Vulnerability Management) เพื่อ:
   - ระบุจุดอ่อนในทรัพย์สิน
   - เข้าใจระดับความเสี่ยง
   - คำนวณและจัดลำดับความสำคัญในการแก้ไข

**คำเตือน**: องค์กรควรทดสอบ patch ที่สำคัญก่อนนำไปใช้จริง เพื่อป้องกันการหยุดชะงักของระบบ

## ระเบียบวิธี (Methodology)

### 8 ขั้นตอนการทำ Network Vulnerability Assessment

1. **ทำการระบุและวิเคราะห์ความเสี่ยง** (Conduct risk identification and analysis)
2. **พัฒนานโยบายการสแกน** (Develop scanning policies)
3. **ระบุประเภทของการสแกน** (Identify scan types)
4. **ตั้งค่าการสแกน** (Configure the scan)
5. **ทำการสแกน** (Perform the scan)
6. **ประเมินความเสี่ยง** (Evaluate risks)
7. **แปลความหมายผลลัพธ์** (Interpret results)
8. **สร้างแผนการแก้ไข** (Create a remediation plan)

## ศัพท์เทคนิคที่ต้องเข้าใจ

### 1. Vulnerability (ช่องโหว่)

**คืออะไร**: จุดอ่อนหรือบั๊กในสภาพแวดล้อมขององค์กร รวมถึง applications, networks, และ infrastructure ที่เปิดโอกาสให้มีภัยคุกคามจากภายนอก

**ระบบการให้คะแนน**:
- บันทึกใน **MITRE's Common Vulnerability Exposure (CVE) database**
- ใช้ **Common Vulnerability Scoring System (CVSS)** กำหนดระดับความรุนแรง
- คะแนน: **0-10**

**ปัจจัยในการให้คะแนน CVSS**:
- ประเภทของ attack vector (network, adjacent, local, physical)
- ความซับซ้อนของการโจมตี (attack complexity)
- สิทธิ์ที่ต้องการ (privileges required)
- ต้องการการกระทำจากผู้ใช้หรือไม่ (user interaction)
- ผลกระทบต่อ:
  - **Confidentiality** (ความลับของข้อมูล)
  - **Integrity** (ความถูกต้องของข้อมูล)
  - **Availability** (ความพร้อมใช้งานของข้อมูล)

**ตัวอย่าง**: SQL injection เป็นช่องโหว่ที่ผู้โจมตีสามารถใช้ queries ดึงข้อมูลจาก database
- ถ้าโจมตีได้โดยไม่ต้อง authentication ผ่าน internet → คะแนน CVSS สูง
- ถ้าต้อง authentication ใน internal network และ application → คะแนน CVSS ต่ำกว่า

### 2. Threat (ภัยคุกคาม)

**คืออะไร**: กระบวนการที่เพิ่มโอกาสของเหตุการณ์ร้ายแรง เช่น ผู้โจมตีใช้ประโยชน์จากช่องโหว่

**การพิจารณา**:
- โอกาสที่จะถูกโจมตี (probability)
- รางวัลที่ผู้โจมตีจะได้ (reward)
- ความง่ายในการโจมตี (ease of exploitation)

→ ยิ่งรางวัลสูง + โจมตีง่าย = มีแนวโน้มถูกโจมตีมากขึ้น

### 3. Exploit (การใช้ประโยชน์จากช่องโหว่)

**คืออะไร**: โค้ดหรือทรัพยากรที่สามารถใช้ประโยชน์จากจุดอ่อนของทรัพย์สิน

**แหล่งที่มา**:
- Exploit-db
- Rapid7 Vulnerability and Exploit Database
- GitHub
- GitLab

### 4. Risk (ความเสี่ยง)

**คืออะไร**: ความเป็นไปได้ที่ทรัพย์สินหรือข้อมูลจะถูกทำลายหรือเสียหายโดยผู้โจมตี

**คำจำกัดความตาม ISO 31000**: 
> "ผลกระทบของความไม่แน่นอนต่อวัตถุประสงค์"
- ผลกระทบอาจเป็นบวก (โอกาส) หรือลบ (ภัยคุกคาม)
- ไม่มีวัตถุประสงค์ = ไม่มีความเสี่ยง

## ความแตกต่างระหว่าง Risk, Threat และ Vulnerability

**สูตร**: **Threat + Vulnerability = Risk**

| ศัพท์ | ความหมาย | ตัวอย่าง |
|-------|----------|----------|
| **Vulnerability** | จุดอ่อนที่ทราบแล้ว | ระบบมีช่องโหว่ SQL injection |
| **Threat** | เหตุการณ์ร้ายที่กำลังเกิดขึ้น | แฮกเกอร์กำลังพยายามโจมตี |
| **Risk** | สิ่งไม่ดีที่อาจเกิดขึ้น | ข้อมูลลูกค้าอาจรั่วไหล |

### วัดความเสี่ยงด้วย Likelihood และ Impact

**Qualitative Risk Matrix**:

| Likelihood \ Impact | **Low Impact** | **Medium Impact** | **High Impact** |
|---------------------|----------------|-------------------|-----------------|
| **High Likelihood** | Medium Risk (3) | High Risk (4) | **Highest Risk (5)** |
| **Medium Likelihood** | Low Risk (2) | Medium Risk (3) | High Risk (4) |
| **Low Likelihood** | **Lowest Risk (1)** | Low Risk (2) | Medium Risk (3) |

**การใช้งาน**:
- ช่องโหว่ที่มี **low likelihood + low impact** = **ความเสี่ยงต่ำสุด (1)**
- ช่องโหว่ที่มี **high likelihood + high impact** = **ความเสี่ยงสูงสุด (5)** → ต้องแก้ไขก่อน

**ตัวอย่าง**: 
- ช่องโหว่ที่มี exploit code พร้อมใช้ + มีแนวโน้มถูกใช้โจมตี = **ความเสี่ยงสูง**
- เพราะผู้โจมตีอาจเข้าถึง internal network และดู/แก้ไข/ลบเอกสารสำคัญได้

## การจัดการทรัพย์สิน (Asset Management)

### ทำไมต้องทำ Asset Management?

> **"ถ้าอยากปกป้องอะไร ต้องรู้ก่อนว่าเรากำลังปกป้องอะไร!"**

องค์กรทุกประเภท ทุกขนาด ควร**เริ่มต้นด้วยการสร้างบัญชีรายการทรัพย์สินข้อมูล** (Asset Inventory) ก่อนวางแผนกลยุทธ์ด้านความปลอดภัยไซเบอร์

### Asset Inventory (บัญชีรายการทรัพย์สิน)

**คืออะไร**: ส่วนประกอบสำคัญของ vulnerability management ที่องค์กรต้องเข้าใจว่ามีทรัพย์สินอะไรบ้างในเครือข่าย

**ประเภทของทรัพย์สิน**:
- Information Technology (IT)
- Operational Technology (OT)
- Physical assets (ทรัพย์สินทางกายภาพ)
- Software assets
- Mobile assets
- Development assets

**เครื่องมือ**: องค์กรควรใช้ **asset management tools** เพื่อติดตามทรัพย์สิน

**Data Classification**: ทรัพย์สินควรมีการจัดประเภทข้อมูล เพื่อให้มีการรักษาความปลอดภัยและควบคุมการเข้าถึงที่เหมาะสม

### รายการทรัพย์สินที่ต้องบันทึก

#### 1. **ข้อมูลที่เก็บในสถานที่ (On-Premises)**
- **Endpoints**: HDDs และ SSDs ใน PCs และอุปกรณ์มือถือ
- **Servers**: HDDs และ SSDs ในเซิร์ฟเวอร์
- **External drives**: ในเครือข่ายท้องถิ่น
- **Optical media**: DVDs, Blu-ray discs, CDs
- **Flash media**: USB sticks, SD cards
- **Legacy technology**: floppy disks, ZIP drives, tape drives

#### 2. **ข้อมูลใน Cloud Provider**
- **Amazon Web Services (AWS)**
- **Google Cloud Platform (GCP)**
- **Microsoft Azure**
- **Multi-cloud**: เครือข่ายที่ใช้หลาย cloud provider

#### 3. **ข้อมูลใน Software-as-a-Service (SaaS)**
ข้อมูลที่อยู่ใน "cloud" แต่อาจไม่อยู่ใน corporate cloud provider account:
- Google Drive
- Dropbox
- Microsoft Teams
- Apple iCloud
- Adobe Creative Suite
- Microsoft Office 365
- Google Docs

#### 4. **Applications ทั้งหมด**
- Applications ที่ติดตั้งในเครื่อง (locally deployed)
- Applications ผ่าน cloud หรือ SaaS

#### 5. **อุปกรณ์เครือข่าย (On-Premises Networking Devices)**
- Routers
- Firewalls
- Hubs
- Switches
- Intrusion Detection/Prevention Systems (IDS/IPS)
- Data Loss Prevention (DLP) systems

### การอัปเดตบัญชีรายการทรัพย์สิน

**สำคัญมาก**: เมื่อมีการเพิ่มหรือลบทรัพย์สินข้อมูล ต้อง**บันทึกอย่างละเอียดในบัญชีรายการทรัพย์สิน**

ทรัพย์สินที่มักมีการเปลี่ยนแปลง:
- คอมพิวเตอร์
- พื้นที่จัดเก็บข้อมูล
- Cloud server capacity
- ทรัพย์สินข้อมูลอื่นๆ

## สรุป

**Vulnerability Assessment** เป็นกระบวนการสำคัญที่:
1. ช่วยระบุช่องโหว่และความเสี่ยงในระบบ
2. ไม่มีการโจมตีจริงแบบ penetration test
3. เหมาะกับทุกองค์กร โดยเฉพาะผู้ที่เริ่มต้นสร้าง security posture
4. ต้องทำอย่างสม่ำเสมอควบคู่กับการจัดการทรัพย์สิน (Asset Management)
5. เป็นพื้นฐานก่อนก้าวไปสู่ penetration testing

# มาตรฐานการประเมิน (Assessment Standards)

## ภาพรวม

**Penetration Tests** และ **Vulnerability Assessments** ต้องปฏิบัติตามมาตรฐานเฉพาะเพื่อให้ได้รับการรับรองและยอมรับจากรัฐบาลและหน่วยงานทางกฎหมาย

**วัตถุประสงค์**:
- ทำให้การประเมินเป็นไปอย่างละเอียดรอบคอบ
- มีวิธีการที่ตกลงกันโดยทั่วไป
- เพิ่มประสิทธิภาพของการประเมิน
- ลดโอกาสการโจมตีองค์กร

## มาตรฐานการปฏิบัติตามข้อกำหนด (Compliance Standards)

หน่วยงานกำกับดูแลแต่ละแห่งมีมาตรฐานความปลอดภัยสารสนเทศของตัวเอง ที่องค์กรต้องปฏิบัติตามเพื่อรักษาการรับรอง

**ทำไมต้องมีการรับรอง?**
1. รับรองว่าองค์กรได้รับการประเมินจากบุคคลที่สามแล้ว
2. จำเป็นสำหรับการดำเนินธุรกิจ - บางบริษัทไม่ทำธุรกิจกับองค์กรที่ไม่มีการรับรองเฉพาะ

### มาตรฐานหลักด้านความปลอดภัยสารสนเทศ

**องค์กรสำคัญ 4 แห่ง:**
- PCI DSS
- HIPAA
- FISMA
- ISO 27001

---

## 1. PCI DSS (Payment Card Industry Data Security Standard)

### คืออะไร
มาตรฐานความปลอดภัยข้อมูลอุตสาหกรรมบัตรชำระเงิน - กำหนดข้อกำหนดสำหรับองค์กรที่จัดการบัตรเครดิต

### ใครต้องปฏิบัติตาม
- **ไม่ใช่**กฎระเบียบของรัฐบาล แต่องค์กรที่**เก็บ ประมวลผล หรือส่งข้อมูลผู้ถือบัตร**จะต้องปฏิบัติตาม
- **ตัวอย่าง**: ธนาคาร, ร้านค้าออนไลน์ที่จัดการระบบชำระเงินเอง (เช่น Amazon)

### ข้อกำหนดสำคัญ

#### Cardholder Data Environment (CDE)
- ข้อมูลบัตรเครดิตที่กำลังประมวลผลหรือส่งต้องอยู่ใน **CDE**
- CDE ต้อง**แยกออกจากทรัพย์สินปกติ**อย่างเพียงพอ
- เป้าหมาย: ป้องกันข้อมูลผู้ถือบัตรจากการถูกโจมตี และจำกัดการเข้าถึงภายใน

#### การสแกน
- ต้องทำการสแกน **internal** และ **external** assets

### เป้าหมาย 6 ข้อของ PCI DSS

1. **สร้างและบำรุงรักษาเครือข่ายที่ปลอดภัย**
2. **ปกป้องข้อมูลผู้ถือบัตร**
3. **บำรุงรักษาโปรแกรมจัดการช่องโหว่**
4. **ใช้มาตรการควบคุมการเข้าถึงที่แข็งแกร่ง**
5. **ตรวจสอบและทดสอบเครือข่ายอย่างสม่ำเสมอ**
6. **บำรุงรักษานโยบายความปลอดภัยสารสนเทศ**

---

## 2. HIPAA (Health Insurance Portability and Accountability Act)

### คืออะไร
พระราชบัญญัติการพกพาและความรับผิดชอบของประกันสุขภาพ - ใช้เพื่อ**ปกป้องข้อมูลผู้ป่วย**

### ข้อกำหนด
- **ไม่จำเป็น**ต้องมี vulnerability scans หรือ assessments
- แต่ต้องมี:
  - **Risk Assessment** (การประเมินความเสี่ยง)
  - **Vulnerability Identification** (การระบุช่องโหว่)

---

## 3. FISMA (Federal Information Security Management Act)

### คืออะไร
พระราชบัญญัติการจัดการความปลอดภัยสารสนเทศของรัฐบาลกลาง - ชุดมาตรฐานและแนวทางปฏิบัติเพื่อ**ปกป้องการดำเนินงานและข้อมูลของรัฐบาล**

### ข้อกำหนด
องค์กรต้องให้:
- **เอกสาร (Documentation)**
- **หลักฐาน (Proof)** ของโปรแกรมจัดการช่องโหว่

**เป้าหมาย**: รักษา
- **Availability** (ความพร้อมใช้งาน)
- **Confidentiality** (ความลับ)
- **Integrity** (ความสมบูรณ์)

ของระบบเทคโนโลยีสารสนเทศของรัฐบาล

---

## 4. ISO 27001

### คืออะไร
มาตรฐานที่ใช้**ทั่วโลก**เพื่อจัดการความปลอดภัยสารสนเทศ

### ข้อกำหนด
- ทำการสแกน **external** และ **internal** **ทุกไตรมาส** (quarterly)

### Information Security Management System (ISMS)
- การปฏิบัติตาม ISO 27001 ขึ้นอยู่กับการรักษา **ISMS ที่มีประสิทธิภาพ**
- องค์กรสามารถทำ penetration tests อย่างรอบคอบเพื่อให้มั่นใจว่าปฏิบัติตามข้อกำหนด

### เกี่ยวกับ ISO
**International Organization for Standardization (ISO)** รักษามาตรฐานทางเทคนิคสำหรับเกือบทุกสิ่ง และ ISO 27001 เกี่ยวข้องกับความปลอดภัยสารสนเทศ

---

## ⚠️ ข้อควรระวัง

> **"แม้ว่า compliance จะสำคัญ แต่ไม่ควรเป็นตัวขับเคลื่อน vulnerability management program"**

**Vulnerability Management ควร**:
- พิจารณาความเป็นเอกลักษณ์ของสภาพแวดล้อม
- พิจารณา risk appetite ที่เกี่ยวข้องกับองค์กร

---

## มาตรฐาน Penetration Testing

### หลักการพื้นฐาน

**Penetration Tests ไม่ควร**ทำโดยไม่มีกฎหรือแนวทางใดๆ

#### ข้อกำหนดบังคับ

1. **Scope ที่ชัดเจน**: ต้องกำหนดขอบเขตที่ชัดเจนเจาะจง
2. **สัญญาทางกฎหมาย**: เจ้าของเครือข่ายต้องมีสัญญาที่ลงนามกับ pentester ระบุ:
   - สิ่งที่**อนุญาต**ให้ทำ
   - สิ่งที่**ไม่อนุญาต**ให้ทำ
3. **ลดอันตราย**: ทำให้เกิดอันตรายต่อคอมพิวเตอร์และเครือข่ายน้อยที่สุด

#### แนวปฏิบัติที่ดี

- **หลีกเลี่ยงการเปลี่ยนแปลง** เท่าที่เป็นไปได้ (เช่น เปลี่ยนรหัสผ่าน)
- **จำกัดข้อมูลที่นำออกจากเครือข่าย**
  - **ตัวอย่าง**: แทนที่จะนำเอกสารสำคัญออกจาก file share ให้ใช้ screenshot ของชื่อโฟลเดอร์เพื่อพิสูจน์ความเสี่ยง

---

## มาตรฐาน Penetration Testing ที่สำคัญ

### 1. PTES (Penetration Testing Execution Standard)

**ใช้กับ**: ทุกประเภทของ penetration tests

**7 ขั้นตอน**:
1. **Pre-engagement Interactions** (การโต้ตอบก่อนเริ่มงาน)
2. **Intelligence Gathering** (การรวบรวมข่าวกรอง)
3. **Threat Modeling** (การสร้างแบบจำลองภัยคุกคาม)
4. **Vulnerability Analysis** (การวิเคราะห์ช่องโหว่)
5. **Exploitation** (การใช้ประโยชน์จากช่องโหว่)
6. **Post Exploitation** (หลังการใช้ประโยชน์)
7. **Reporting** (การรายงาน)

---

### 2. OSSTMM (Open Source Security Testing Methodology Manual)

**คืออะไร**: ชุดแนวทางที่ pentester สามารถใช้เพื่อให้แน่ใจว่าทำงานอย่างถูกต้อง สามารถใช้ร่วมกับมาตรฐาน pentest อื่นๆ ได้

**5 ช่องทาง (Channels)**:

1. **Human Security** (ความปลอดภัยของมนุษย์)
   - มนุษย์เป็นเป้าหมายของ social engineering exploits

2. **Physical Security** (ความปลอดภัยทางกายภาพ)

3. **Wireless Communications** (การสื่อสารไร้สาย)
   - WiFi, Bluetooth, และเทคโนโลยีอื่นๆ

4. **Telecommunications** (โทรคมนาคม)

5. **Data Networks** (เครือข่ายข้อมูล)

---

### 3. NIST (National Institute of Standards and Technology)

**ที่รู้จักกัน**: NIST Cybersecurity Framework - ระบบออกแบบนโยบายและขั้นตอนการตอบสนองต่อเหตุการณ์

**NIST Penetration Testing Framework มี 4 ขั้นตอน**:

1. **Planning** (การวางแผน)
2. **Discovery** (การค้นพบ)
3. **Attack** (การโจมตี)
4. **Reporting** (การรายงาน)

---

### 4. OWASP (Open Web Application Security Project)

**คืออะไร**: องค์กรหลักในการกำหนดมาตรฐานการทดสอบและจัดประเภทความเสี่ยงสำหรับ **web applications**

**มาตรฐานและคู่มือที่สำคัญ**:

1. **WSTG (Web Security Testing Guide)**
   - คู่มือทดสอบความปลอดภัยเว็บ

2. **MSTG (Mobile Security Testing Guide)**
   - คู่มือทดสอบความปลอดภัยมือถือ

3. **Firmware Security Testing Methodology**
   - วิธีการทดสอบความปลอดภัย firmware

---

## สรุปเปรียบเทียบมาตรฐาน

### Compliance Standards (สำหรับองค์กร)

| มาตรฐาน | เหมาะกับ | ข้อกำหนดหลัก |
|---------|---------|--------------|
| **PCI DSS** | ธุรกิจที่จัดการบัตรเครดิต | สแกน internal/external, แยก CDE |
| **HIPAA** | สถานพยาบาล, ประกันสุขภาพ | Risk assessment, ระบุช่องโหว่ |
| **FISMA** | หน่วยงานรัฐบาล | มี vulnerability management program |
| **ISO 27001** | ทุกองค์กรทั่วโลก | สแกนทุกไตรมาส, มี ISMS |

### Penetration Testing Standards (สำหรับ Pentester)

| มาตรฐาน | จุดเด่น | ใช้กับ |
|---------|---------|--------|
| **PTES** | ครอบคลุม 7 ขั้นตอนครบถ้วน | ทุกประเภท pentest |
| **OSSTMM** | แบ่ง 5 ช่องทางชัดเจน | ใช้ร่วมกับมาตรฐานอื่น |
| **NIST** | เรียบง่าย 4 ขั้นตอน | หน่วยงานรัฐบาลสหรัฐฯ |
| **OWASP** | เชี่ยวชาญเฉพาะด้าน | Web apps, Mobile apps, Firmware |

---

## ข้อสรุป

1. **ปฏิบัติตามมาตรฐาน** = ความน่าเชื่อถือและการยอมรับ
2. **เลือกมาตรฐานให้เหมาะสม** กับอุตสาหกรรมและประเภทธุรกิจ
3. **Compliance ≠ Security** - การปฏิบัติตามข้อกำหนดเป็นเพียงพื้นฐาน ต้องพัฒนาต่อ
4. **Pentesting ต้องมีกฎเกณฑ์** - มี scope, สัญญา, และมาตรฐานชัดเจน
5. **ลดอันตราย** - ทดสอบอย่างระมัดระวังเพื่อไม่ให้กระทบกับธุรกิจ